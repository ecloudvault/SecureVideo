package com.oscgc.securevideo.server.mvc.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.RequestMapping;import com.oscgc.securevideo.server.model.UserKey;import com.oscgc.securevideo.server.security.SecurityUtils;import com.oscgc.securevideo.server.security.User;import com.oscgc.securevideo.server.service.UserKeyService;/** * Created by Yq on 2015/6/10. */@Controller@RequestMapping("/key")public class UserKeyController {        @Autowired    private UserKeyService userKeyService;        @RequestMapping("pemKey")    public String keyView(ModelMap map) {                User user = SecurityUtils.currentUser();        if (user != null) {            UserKey userKey = userKeyService.findByUsername(user.getUsername());            map.put("userKey", userKey);        }        return "/user/rsaKey";    }        @RequestMapping("reGenerate")    public String reGenerate() {        User user = SecurityUtils.currentUser();                if (user != null) {            UserKey userKey = userKeyService.findByUsername(user.getUsername());            userKeyService.reGenerate(userKey);        }        return "redirect:/key/pemKey";    }}